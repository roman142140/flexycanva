function flex(){let t=Math.PI,h=2*t,i=t/2,s=(t,h)=>Math.atan2(h.y-t.y,h.x-t.x),n=(t,h)=>Math.hypot(h.y-t.y,h.x-t.x),a={quality:1,Point:class{constructor(t=0,h=0){this.x=t,this.y=h}},Brush:class{constructor(t,h){this.x=t,this.y=h,this.path=[],this.path.push(new a.Point(t,h))}move(t,h){this.x+=t,this.y+=h,this.path.push(new a.Point(this.x,this.y))}moveDistDir(t,h){this.x+=t*Math.cos(h),this.y+=t*Math.sin(h),this.path.push(new a.Point(this.x,this.y))}moveTo(t,h){this.x=t,this.y=h,this.path.push(new Point(this.x,this.y))}}};return Shape={draw(t){t.beginPath();for(let h=0;h<this.path.length;h++)t.lineTo(this.x+this.path[h].x,this.y+this.path[h].y);t.closePath()},fill(t){this.draw(t),t.fill()},stroke(t){this.draw(t),t.stroke()},translateX(t=0){this.path=this.path.map(h=>new a.Point(h.x+t,h.y))},translateY(t=0){this.path=this.path.map(h=>new a.Point(h.x,h.y+t))},translate(t,h){this.path=this.path.map(i=>new a.Point(i.x+t,i.y+h))},sqewX(t){let h=this.h||this.r2||this.r;this instanceof Star&&(h=this.r1>this.r2?this.r1:this.r2),this.path=this.path.map(i=>new a.Point(i.x+t*i.y/h,i.y))},sqewY(t){let h=this.w||this.r1||this.r;this instanceof Star&&(h=this.r1>this.r2?this.r1:this.r2),this.path=this.path.map(i=>new a.Point(i.x,i.y+t*i.x/h))},rotate(t){let h=0,i=0;this.path=this.path.map(o=>(h=s(new a.Point(0,0),new a.Point(o.x,o.y)),i=n(new a.Point(0,0),new a.Point(o.x,o.y)),new a.Point(Math.cos(h+t)*i,Math.sin(h+t)*i)))},inflate(t=0,h=0){let i=0,o=0,e=t;this.path=this.path.map(r=>(i=s(new Point(0,0),new a.Point(r.x,r.y)),o=n(new Point(0,0),new a.Point(r.x,r.y)),e=h?t*(this.R/2/o):t,new a.Point(Math.cos(i)*(o+e),Math.sin(i)*(o+e))))},twist(t){let h=0,i=0,o=t/this.R;this.path=this.path.map(t=>(h=s(new Point(0,0),new a.Point(t.x,t.y)),i=n(new Point(0,0),new a.Point(t.x,t.y)),new a.Point(Math.cos(h+o*i)*i,Math.sin(h+o*i)*i)))},scaleX(t){this.path=this.path.map(h=>new a.Point(h.x*t,h.y))},scaleY(t){this.path=this.path.map(h=>new a.Point(h.x,h.y*t))},scale(t){this.path=this.path.map(h=>new a.Point(h.x*t,h.y*t))},reset(){this.build(a.quality)}},a.Ellipse=class{constructor(t=0,i=0,s=0,n=0){this.x=t,this.y=i,this.r1=s,this.r2=n,this.R=s>n?s:n,this.P=h*Math.sqrt((this.r1**2+this.r2**2)/2),this.path=[],this.build(a.quality)}build(t=1){this.path=[];let i=Math.floor(this.P/t);i=i<12?12:i;for(let t=0;t<i;t++)this.path.push(new a.Point(Math.cos(t/i*h)*this.r1,Math.sin(t/i*h)*this.r2))}},Object.assign(a.Ellipse.prototype,Shape),a.Rect=class{constructor(t=0,h=0,i=0,s=0,n=0){this.x=t,this.y=h,this.w=i,this.h=s,this.r=n,this.R=Math.hypot(i,s)/2,this.path=[],this.build(a.quality)}build(h=1){let s=new a.Brush(this.w/2,this.h/2),n=Math.floor(this.w/h),o=Math.floor(this.h/h);n=n<3?3:n,o=o<3?3:o;for(let h=0;h<n;h++)s.moveDistDir(this.w/n,t);for(let h=0;h<o;h++)s.moveDistDir(this.h/o,t+i);for(let t=0;t<n;t++)s.moveDistDir(this.w/n,0);for(let t=0;t<o;t++)s.moveDistDir(this.h/o,i);this.path=s.path}},Object.assign(a.Rect.prototype,Shape),a.Triangle=class{constructor(t,h,i,s){this.x=t,this.y=h,this.w=i,this.h=s,this.R=s/2>Math.hypot(s/2,i/2)?s/2:Math.hypot(s/2,i/2),this.path=[],this.build(a.quality)}build(t){let h=new a.Brush(this.h/2,0),o=n(new a.Point(this.h/2,0),new a.Point(-this.h/2,this.w/2)),e=Math.floor(o/t),r=Math.floor(this.w/t);e=e<3?3:e,r=r<3?3:r;for(let t=0;t<e;t++)h.moveDistDir(o/e,s(new a.Point(this.h/2,0),new a.Point(-this.h/2,this.w/2)));for(let t=0;t<r;t++)h.moveDistDir(this.w/r,-i);for(let t=0;t<e;t++)h.moveDistDir(o/e,s(new a.Point(-this.h/2,-this.w/2),new a.Point(this.h/2,0)));this.path=h.path}},Object.assign(a.Triangle.prototype,Shape),a.Polygone=class{constructor(t,h,i,s){this.x=t,this.y=h,this.r=i,this.n=s<3?3:s,this.R=i,this.path=[],this.build(a.quality)}build(i){let n=new a.Brush(this.r,0),o=this.r*Math.sin(t/this.n)*2,e=Math.floor(o/i);e=e<3?3:e;for(let t=0;t<this.n;t++)for(let i=0;i<e;i++)n.moveDistDir(o/e,s(new a.Point(this.r*Math.cos(t*h/this.n),this.r*Math.sin(t*h/this.n)),new a.Point(this.r*Math.cos((t+1)*h/this.n),this.r*Math.sin((t+1)*h/this.n))));this.path=n.path}},Object.assign(a.Polygone.prototype,Shape),a.Star=class{constructor(t,h,i,s,n){this.x=t,this.y=h,this.r1=i,this.r2=s,this.R=i>s?i:s,this.n=n<2?2:n,this.path=[],this.build(a.quality)}build(t){let i=new a.Brush(this.r1,0),o=n(new a.Point(this.r1*Math.cos(0*h/this.n),this.r1*Math.sin(0*h/this.n)),new a.Point(this.r2*Math.cos(.5*h/this.n),this.r2*Math.sin(.5*h/this.n))),e=Math.floor(o/t);e=e<3?3:e;for(let t=0;t<this.n;t++){for(let n=0;n<e;n++)i.moveDistDir(o/e,s(new a.Point(this.r1*Math.cos(t*h/this.n),this.r1*Math.sin(t*h/this.n)),new a.Point(this.r2*Math.cos((t+.5)*h/this.n),this.r2*Math.sin((t+.5)*h/this.n))));for(let n=0;n<e;n++)i.moveDistDir(o/e,s(new a.Point(this.r2*Math.cos((t+.5)*h/this.n),this.r2*Math.sin((t+.5)*h/this.n)),new a.Point(this.r1*Math.cos((t+1)*h/this.n),this.r1*Math.sin((t+1)*h/this.n))))}this.path=i.path}},Object.assign(a.Star.prototype,Shape),a}
